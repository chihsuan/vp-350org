!function(t){var e=["China","Taiwan","Japan","Vietnam","North Korea","South Korea","Philippines","Thailand","Malaysia","Indonesia","Cambodia","Laos","Myanmar","Singapore","Brunei","East Timor","Mongolia"],n=$(t).width(),r=$(t).height(),a=d3.select("#east-asia-map").append("svg").attr("width",n).attr("height",r),o=500,i=n<600;i&&(o=300),d3.json("data/countries.geo.topo.json",function(t,c){if(t)return console.error(t);var s=[110.5,23],u=d3.geo.mercator().scale(o).center(s).translate([n/2+10,r/2+50]),l=d3.geo.path().projection(u);a.append("g").attr("class","countries").selectAll("path").data(topojson.feature(c,c.objects["countries.geo"]).features).enter().append("path").attr("d",l).style("display",function(t){return e.indexOf(t.properties.name)>-1?"block":"none"}).attr("fill",function(t){if("Vietnam"===t.properties.name)return"rgba(218, 55, 47, 0.9)"}),a.append("path").attr("class","country-borders").attr("d",l(topojson.mesh(c,c.objects["countries.geo"],function(t,n){return e.indexOf(t.properties.name)>-1&&t!==n}))),a.append("text").text("East Asia").attr("class","map-title").attr("y",function(){return i?"150px":r/2}).attr("x",function(){return i?n/2:n/5*4}).attr("text-anchor","middle");var p=topojson.feature(c,c.objects["countries.geo"]).features;p=p.filter(function(t){return"Vietnam"===t.properties.name});var d=p.map(function(t){return{name:t.properties.name,center:l.centroid(t)}});a.selectAll(".place-label").data(d).enter().append("text").attr("class","place-label").text(function(t){return t.name}).attr("x",function(t){return t.center[0]}).attr("y",function(t){return t.center[1]})});var c={children:[{value:4},{value:2},{value:10},{value:5},{value:8},{value:10}]},s=d3.layout.treemap().size([n,400]),u=s.nodes(c);u=u.slice(1,u.length);var l=d3.select("#bank-treemap").append("svg").attr("width",n).attr("height",400);l.selectAll("rect").data(u).enter().append("rect").attr({x:function(t){return t.x},y:function(t){return t.y},width:function(t){return t.dx},height:function(t){return t.dy},class:"bank-treemap-rect"}),l.selectAll("text").data(u).enter().append("text").attr({x:function(t){return t.x+t.dx/4},y:function(t){return t.y+t.dy/3},"text-anchor":"middle","dominant-baseline":"central"}).text(function(t){return"Bank"}).style("font-size","16px");var u=(d3.layout.treemap().size([n,400]),s.nodes(c));u=u.slice(1,u.length);var p=d3.select("#proj-treemap").append("svg").attr("width",n).attr("height",400);p.selectAll("rect").data(u).enter().append("rect").attr({x:function(t){return t.x},y:function(t){return t.y},width:function(t){return t.dx},height:function(t){return t.dy},class:"proj-treemap-rect"}),p.selectAll("text").data(u).enter().append("text").attr({x:function(t){return t.x+t.dx/4},y:function(t){return t.y+t.dy/3},"text-anchor":"middle","dominant-baseline":"central"}).text(function(t){return"Project"}).style("font-size","16px")}(window);